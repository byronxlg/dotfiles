#!/bin/bash

# Basic terminal settings
set -g default-terminal "tmux-256color"

# Enable mouse control (clickable windows, panes, resizable panes)
set -g mouse on

# Indexing windows and panes
setw -g pane-base-index 1
set -g base-index 1

# Prefix key
set -g prefix C-b

# Split panes
unbind %
unbind '"'
bind | split-window -h  # Vertical split
bind - split-window -v  # Horizontal split

# Kill pane (Enter or y to confirm)
unbind x
bind x command-prompt -I y -p "kill-pane #P? (y/n): " "if-shell -F '%%=y' 'kill-pane' 'if-shell -F \"%%=Y\" \"kill-pane\" \"if-shell -F \"%%=yes\" \"kill-pane\" \"if-shell -F \"%%=Yes\" \"kill-pane\" \"if-shell -F \"%%=YES\" \"kill-pane\" \"\"\"'"

# Reload config file
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# ============================================================================
# STATUS LINE
# ============================================================================
# Enable status line
set -g status on

# Status line position (top or bottom)
set -g status-position top

# Status line update interval (seconds)
set -g status-interval 1

# Status left look and feel
set -g status-left-length 100
set -g status-left ""
set -ga status-left "#[bg=default,fg=#{@thm_blue}]  #S "
set -ga status-left "#[bg=default,fg=#{@thm_mauve},none]│"
set -ga status-left "#[bg=default,fg=#{@thm_blue}]  #{pane_current_command} "
set -ga status-left "#[bg=default,fg=#{@thm_mauve},none]│"
set -ga status-left "#[bg=default,fg=#{@thm_blue}]  #{=/-32/...:#{s|$USER|~|:#{b:pane_current_path}}} "

# Status right look and feel
set -g status-right-length 100
set -g status-right ""
# Show prefix indicator when active (simple green dot)
set -ga status-right "#{?client_prefix,● ,}"
set -ga status-right "#[bg=default,fg=#{@thm_blue}]  %Y-%m-%d "
set -ga status-right "#[bg=default,fg=#{@thm_mauve},none]│"
set -ga status-right "#[bg=default,fg=#{@thm_blue}]  %H:%M "

# Configure Tmux
set -g status-position top
set -g status-style "bg=default"
set -g status-justify "absolute-centre"

# pane border look and feel
setw -g pane-border-status top
setw -g pane-border-format ""
# Active pane border - use Catppuccin mauve for visibility
setw -g pane-active-border-style "bg=default,fg=#{@thm_mauve},bold"
# Inactive pane border - subtle gray
setw -g pane-border-style "bg=default,fg=#{@thm_overlay_0}"

# ============================================================================
# DEFAULT TMUX BINDINGS (for reference)
# ============================================================================
# These are the default bindings that come with tmux. Uncomment and modify
# as needed, or leave commented to use defaults.

# Session Management
# bind-key C-b detach-client                    # Detach client (default prefix)
# bind-key s choose-tree -Zs                    # Choose a session from tree
# bind-key C-s choose-tree -Zs                   # Choose a session from tree
# bind-key S switch-client -l                   # Switch to last session

# Window Management
# bind-key c new-window                         # Create new window
# bind-key , command-prompt -I "#W" "rename-window '%%'"  # Rename window
# bind-key . command-prompt "move-window -t '%%'"  # Move window
# bind-key 0 select-window -t :0                # Select window 0
# bind-key 1 select-window -t :1                # Select window 1
# bind-key 2 select-window -t :2                # Select window 2
# bind-key 3 select-window -t :3                # Select window 3
# bind-key 4 select-window -t :4                # Select window 4
# bind-key 5 select-window -t :5                # Select window 5
# bind-key 6 select-window -t :6                # Select window 6
# bind-key 7 select-window -t :7                # Select window 7
# bind-key 8 select-window -t :8                # Select window 8
# bind-key 9 select-window -t :9                # Select window 9
# bind-key M-0 select-window -t :10             # Select window 10
# bind-key M-1 select-window -t :11             # Select window 11
# bind-key M-2 select-window -t :12             # Select window 12
# bind-key M-3 select-window -t :13             # Select window 13
# bind-key M-4 select-window -t :14             # Select window 14
# bind-key M-5 select-window -t :15             # Select window 15
# bind-key M-6 select-window -t :16             # Select window 16
# bind-key M-7 select-window -t :17             # Select window 17
# bind-key M-8 select-window -t :18             # Select window 18
# bind-key M-9 select-window -t :19             # Select window 19
# bind-key n next-window                         # Next window
# bind-key p previous-window                    # Previous window
# bind-key l last-window                         # Last window
# bind-key w choose-tree -Zw                    # Choose window from tree
# bind-key & confirm-before -p "kill-window #W? (y/n)" kill-window  # Kill window
# bind-key f command-prompt "find-window '%%'"  # Find window

# Pane Management
# bind-key % split-window -h                     # Split window vertically
# bind-key " split-window                        # Split window horizontally
# bind-key o select-pane -t :.+                  # Next pane
# bind-key ; select-pane -t :.+                  # Next pane
# bind-key Up select-pane -U                     # Select pane up
# bind-key Down select-pane -D                   # Select pane down
# bind-key Left select-pane -L                   # Select pane left
# bind-key Right select-pane -R                   # Select pane right
# bind-key M-1 select-layout even-horizontal     # Even horizontal layout
# bind-key M-2 select-layout even-vertical       # Even vertical layout
# bind-key M-3 select-layout main-horizontal     # Main horizontal layout
# bind-key M-4 select-layout main-vertical       # Main vertical layout
# bind-key M-5 select-layout tiled               # Tiled layout
# bind-key Space select-layout -n o               # Next layout
# bind-key C-Up resize-pane -U                   # Resize pane up
# bind-key C-Down resize-pane -D                 # Resize pane down
# bind-key C-Left resize-pane -L                 # Resize pane left
# bind-key C-Right resize-pane -R                # Resize pane right
# bind-key z resize-pane -Z                      # Zoom/unzoom pane
# bind-key x confirm-before -p "kill-pane #P? (y/n)" kill-pane  # Kill pane
# bind-key q display-panes                       # Display pane numbers
# bind-key { swap-pane -U                        # Swap pane with previous
# bind-key } swap-pane -D                        # Swap pane with next
# bind-key t command-prompt -p "pane target: " "swap-pane -t '%%'"  # Swap pane to target

# Copy Mode (emacs mode by default)
# bind-key [ copy-mode                           # Enter copy mode
# bind-key ] paste-buffer                        # Paste buffer
# bind-key = choose-buffer                       # Choose buffer
# bind-key -T copy-mode C-Space send-keys -X begin-selection  # Start selection
# bind-key -T copy-mode C-w send-keys -X copy-selection-and-cancel  # Copy selection
# bind-key -T copy-mode Escape send-keys -X cancel  # Cancel selection
# bind-key -T copy-mode C-c send-keys -X clear-selection  # Clear selection
# bind-key -T copy-mode M-w send-keys -X copy-selection-and-cancel  # Copy selection
# bind-key -T copy-mode MouseDragEnd1Pane send-keys -X copy-selection-and-cancel  # Copy on mouse drag

# Copy Mode Navigation (emacs)
# bind-key -T copy-mode Up send-keys -X cursor-up
# bind-key -T copy-mode Down send-keys -X cursor-down
# bind-key -T copy-mode Left send-keys -X cursor-left
# bind-key -T copy-mode Right send-keys -X cursor-right
# bind-key -T copy-mode C-b send-keys -X cursor-left
# bind-key -T copy-mode C-f send-keys -X cursor-right
# bind-key -T copy-mode M-f send-keys -X next-word
# bind-key -T copy-mode M-b send-keys -X previous-word
# bind-key -T copy-mode M-< send-keys -X start-of-line
# bind-key -T copy-mode M-> send-keys -X end-of-line
# bind-key -T copy-mode C-v send-keys -X page-down
# bind-key -T copy-mode M-v send-keys -X page-up
# bind-key -T copy-mode H send-keys -X start-of-line
# bind-key -T copy-mode M send-keys -X middle-of-line
# bind-key -T copy-mode L send-keys -X end-of-line

# Other
# bind-key : command-prompt                       # Command prompt
# bind-key ? list-keys                           # List all key bindings
# bind-key t clock-mode                          # Show clock
# bind-key r refresh-client                      # Refresh client
# bind-key L switch-client -l                    # Switch to last client
# bind-key D choose-client                       # Choose client
# bind-key C-b send-prefix                       # Send prefix key
# bind-key * list-buffers                        # List paste buffers
# bind-key PPage copy-mode -u                    # Page up in copy mode
# bind-key -T root MouseDown1Pane select-pane -t = \; send-keys -M  # Mouse select pane
# bind-key -T root MouseDown1Status select-window -t =  # Mouse select window
# bind-key -T root MouseDrag1Pane resize-pane -t = \; send-keys -M  # Mouse resize pane
# bind-key -T root MouseDrag1Status resize-window -t =  # Mouse resize window
# bind-key -T root DoubleClick1Pane select-pane -t = \; send-keys -M  # Double click pane
# bind-key -T root DoubleClick1Status select-window -t =  # Double click window
# bind-key -T root TripleClick1Pane select-pane -t = \; send-keys -M  # Triple click pane
# bind-key -T root TripleClick1Status select-window -t =  # Triple click window
# bind-key -T root WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if-shell -t = '#{pane_in_mode}' 'send-keys -M' 'copy-mode -t =; send-keys -M'"  # Mouse wheel up
# bind-key -T root WheelDownPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if-shell -t = '#{pane_in_mode}' 'send-keys -M' 'send-keys -M'"  # Mouse wheel down
# bind-key -T root WheelUpStatus select-window -t =  # Mouse wheel up status
# bind-key -T root WheelDownStatus select-window -t =  # Mouse wheel down status

# ============================================================================
# TMUX PLUGIN MANAGER (TPM)
# ============================================================================
# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'catppuccin/tmux'

# Catppuccin theme configuration
set -g @catppuccin_flavour 'mocha' # latte, frappe, macchiato, mocha
# Disable plugin's status bar to preserve custom status bar
set -g @catppuccin_status_modules_left ""
set -g @catppuccin_status_modules_right ""
# Window configuration (optional - customize as needed)
set -g @catppuccin_window_left_separator "█"
set -g @catppuccin_window_right_separator "█"
set -g @catppuccin_window_middle_separator "█ "
set -g @catppuccin_window_number_position "right"
set -g @catppuccin_window_default_fill "number"
set -g @catppuccin_window_default_text "#W"
set -g @catppuccin_window_current_fill "number"
set -g @catppuccin_window_current_text "#W"

# Initialize TPM (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

